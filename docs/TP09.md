## Métriques réseau


Créer une GlobalNetworkPolicy Cilium NP qui permet de logger les accès depuis tous les NS (sauf ceux débutant en kube- ou cilium-) vers le monde HTTP

Depuis un Pod quelconque , tester :

## Monitoring

Activons l'export Prometheus de Cilium :
```shell
cilium config set prometheus.enabled true
cilium config set operator.prometheus.enabled true
```
et pour Hubble
```shell
cilium config set hubble.metrics.enabled "{dns,drop,tcp,flow,icmp,http}"
```

Nous allons installer un stack de monitoring Prometheus+Grafana

```shell
kubectl apply -f https://raw.githubusercontent.com/cilium/cilium/v1.12/examples/kubernetes/addons/prometheus/monitoring-example.yaml
```

Puis

```shell
kubectl -n cilium-monitoring port-forward service/grafana --address 0.0.0.0 --address :: 3000:3000
```

Il ne reste plus qu'à visiter http://127.0.0.1:3000 !

---
[Revenir au sommaire](../README.md) | [TP Suivant](./TP10.md)
